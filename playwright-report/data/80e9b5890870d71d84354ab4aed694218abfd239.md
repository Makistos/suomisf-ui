# Test info

- Name: Publisher series page loads and displays data
- Location: /home/mep/src/suomisf-ui/tests/pubseries.spec.ts:3:1

# Error details

```
Error: expect(locator).not.toBeVisible()

Locator: getByRole('progressbar')
Expected: not visible
Received: visible
Call log:
  - expect.not.toBeVisible with timeout 60000ms
  - waiting for getByRole('progressbar')
    32 × locator resolved to <div aria-busy="true" role="progressbar" data-pc-section="root" class="p-progress-spinner" data-pc-name="progressspinner">…</div>
       - unexpected value "visible"

    at /home/mep/src/suomisf-ui/tests/pubseries.spec.ts:14:53
```

# Page snapshot

```yaml
- link "SuomiSF":
  - /url: /
- menubar:
  - menuitem "Kirjat":
    - link "Kirjat":
      - /url: /bookindex
  - menuitem "Lehdet":
    - link "Lehdet":
      - /url: /magazines
  - menuitem "Novellit":
    - link "Novellit":
      - /url: /shortstoryindex
  - menuitem "Hakemistot":
    - link "Hakemistot":
      - /url: "#"
      - text: Hakemistot
      - img
  - menuitem "":
    - link "":
      - /url: "#"
      - text: 
      - img
- combobox "Etsi"
- main:
  - heading "Kustantajien sarjat" [level=1]
  - progressbar:
    - img
- button "Open Tanstack query devtools":
  - img
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | test('Publisher series page loads and displays data', async ({ page }) => {
   4 |     page.on('request', request => console.log('>>', request.method(), request.url()));
   5 |     page.on('response', response => console.log('<<', response.status(), response.url()));
   6 |     // Navigate to publisher series page with longer timeout
   7 |     await page.goto('/pubseries');
   8 |     // await expect(page).toHaveURL(/.*\/pubseries/);
   9 |
  10 |     // Check that the page heading exists and wait for it
  11 |     await expect(page.getByRole('heading', { name: /Kustantajien sarjat/i }))
  12 |         .toBeVisible({ timeout: 20000 });
  13 |
> 14 |     await expect(page.getByRole('progressbar')).not.toBeVisible({ timeout: 60000 });
     |                                                     ^ Error: expect(locator).not.toBeVisible()
  15 |
  16 |     // Wait for table with retry logic
  17 |     // await expect(async () => {
  18 |     //     const table = page.getByRole('table');
  19 |     //     await expect(table).toBeVisible({ timeout: 20000 });
  20 |     //     const rowCount = await page.getByRole('row').count();
  21 |     //     expect(rowCount).toBeGreaterThan(1);
  22 |     // }).toPass({ timeout: 60000 });
  23 |
  24 |     // // Verify essential columns exist using first() to handle multiple matches
  25 |     // await expect(page.getByRole('columnheader', { name: /Nimi/i }).first()).toBeVisible();
  26 |     // await expect(page.getByRole('columnheader', { name: /Kustantaja/i }).first()).toBeVisible();
  27 |     // await expect(page.getByRole('columnheader', { name: /Kirjoja/i }).first()).toBeVisible();
  28 |
  29 |     // // Wait for and check total number of series
  30 |     // await expect(async () => {
  31 |     //     const totalText = await page.getByText(/Sarjoja yhteensä/).textContent();
  32 |     //     const totalCount = totalText ? parseInt(totalText.match(/\d+/)?.[0] || '0') : 0;
  33 |     //     expect(totalCount).toBeGreaterThan(0);
  34 |     // }).toPass();
  35 |
  36 |     // const totalText = await page.getByText(/Sarjoja yhteensä/).textContent();
  37 |     // const totalCount = totalText ? parseInt(totalText.match(/\d+/)?.[0] || '0') : 0;
  38 |     // expect(totalCount).toBeGreaterThan(270);
  39 |     // expect(totalCount).toBeLessThan(500);
  40 |
  41 |     // // Find the specific row by name and verify its contents
  42 |     // const targetRow = page.getByRole('row').filter({ hasText: 'Action-sarja' });
  43 |     // await expect(targetRow).toBeVisible();
  44 |
  45 |     // // Get all cells from the target row and verify their contents
  46 |     // const cells = targetRow.getByRole('cell');
  47 |     // await expect(cells.nth(0)).toHaveText('Action-sarja');
  48 |     // await expect(cells.nth(1)).toHaveText('Viihdeviikarit');
  49 |     // await expect(cells.nth(2)).toHaveText('6');
  50 | });
  51 |
```